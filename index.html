<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Learner - Grade Based Quiz</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --bg: #0d1117; --card: #161b22; --primary: #58a6ff;
            --success: #238636; --error: #da3633; --text: #c9d1d9;
            --opt-bg: #21262d; --border: #30363d;
        }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 15px; }
        .container { max-width: 600px; margin: auto; }
        .card { background: var(--card); padding: 25px; border-radius: 15px; border: 1px solid var(--border); box-shadow: 0 8px 24px rgba(0,0,0,0.5); margin-bottom: 20px; }
        
        h2 { color: var(--primary); text-align: center; margin-bottom: 20px; }
        .grid-menu { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
        
        .menu-btn { background: var(--opt-bg); border: 1px solid var(--border); color: white; padding: 20px; border-radius: 10px; cursor: pointer; font-size: 16px; font-weight: bold; transition: 0.3s; text-align: center; }
        .menu-btn:hover { background: var(--primary); color: #000; transform: translateY(-3px); }
        
        .stats-bar { display: flex; justify-content: space-between; margin-bottom: 20px; font-size: 0.9em; color: #8b949e; }
        .option { background: var(--opt-bg); padding: 15px; border-radius: 10px; margin-bottom: 10px; cursor: pointer; border: 1px solid var(--border); }
        .correct { border-color: var(--success) !important; background: rgba(35, 134, 54, 0.1) !important; }
        .wrong { border-color: var(--error) !important; background: rgba(218, 54, 51, 0.1) !important; }
        .explanation { font-size: 0.85em; color: #8b949e; margin-top: 10px; display: none; padding-top: 10px; border-top: 1px solid var(--border); line-height: 1.5; }
        
        button.action-btn { background: var(--success); color: white; border: none; padding: 15px; border-radius: 8px; cursor: pointer; width: 100%; font-weight: bold; margin-top: 15px; }
        .hidden { display: none; }
    </style>
</head>
<body>

<div class="container">
    <div id="gradeScreen" class="card">
        <h2>ශ්‍රේණිය තෝරන්න (Select Grade)</h2>
        <div class="grid-menu">
            <div class="menu-btn" onclick="selectGrade('6')">Grade 6</div>
            <div class="menu-btn" onclick="selectGrade('7')">Grade 7</div>
            <div class="menu-btn" onclick="selectGrade('8')">Grade 8</div>
            <div class="menu-btn" onclick="selectGrade('9')">Grade 9</div>
            <div class="menu-btn" onclick="selectGrade('10')">Grade 10</div>
            <div class="menu-btn" onclick="selectGrade('11')">O/L (Grade 11)</div>
            <div class="menu-btn" onclick="selectGrade('12')">A/L (Grade 12)</div>
            <div class="menu-btn" onclick="selectGrade('13')">A/L (Grade 13)</div>
        </div>
    </div>

    <div id="subjectScreen" class="card hidden">
        <button onclick="goBack('gradeScreen')" style="background:none; border:none; color:var(--primary); cursor:pointer; margin-bottom:10px;">← ආපසු</button>
        <h2 id="selectedGradeTitle">Subjects</h2>
        <div id="subjectList" class="grid-menu">
            </div>
    </div>

    <div id="quizArea" class="card hidden">
        <div class="stats-bar">
            <span id="qCount">ප්‍රශ්නය 1</span>
            <span id="subName" style="color:var(--primary); font-weight:bold;">SUBJECT</span>
        </div>
        <h3 id="qTxt" style="line-height:1.4;">ප්‍රශ්නය මෙතැන දිස්වේ...</h3>
        <div id="optCont"></div>
        <button id="nextBtn" class="action-btn hidden" onclick="nextQuestion()">මීළඟ ප්‍රශ්නය</button>
        <button onclick="goBack('subjectScreen')" style="background:none; border:none; color:#555; cursor:pointer; margin-top:15px; width:100%;">වැඩසටහන නවත්වන්න</button>
    </div>

    <div id="resultScreen" class="card hidden">
        <h2>අද දින ප්‍රගතිය</h2>
        <div style="text-align:center; margin-bottom:20px;">
            <span style="font-size:3em; font-weight:bold; color:var(--success);" id="finalScore">0</span>
            <p>ලබාගත් ලකුණු</p>
        </div>
        <div style="height:200px;"><canvas id="progChart"></canvas></div>
        <button class="action-btn" onclick="location.reload()">මුල සිට ආරම්භ කරන්න</button>
    </div>
</div>

<script>
    let currentGrade = "";
    let currentSubject = "";
    let score = 0;
    let qIdx = 0;

    // Database structure
    const subjectsPerGrade = {
        "6": ["විද්‍යාව", "ගණිතය", "ඉතිහාසය", "සිංහල", "ඉංග්‍රීසි", "ආගම"],
        "11": ["විද්‍යාව", "ගණිතය", "ඉතිහාසය", "ICT", "කෘෂිකර්මය", "සෞඛ්‍යය"],
        "13": ["රසායන විද්‍යාව", "භෞතික විද්‍යාව", "ජීව විද්‍යාව", "ගණිතය"]
    };

    const questionsDB = {
        "විද්‍යාව": [{q: "පදාර්ථයේ කුඩාම තැනුම් ඒකකය කුමක්ද?", o: ["අණුව", "පරමාණුව", "සෛලය", "ඉලෙක්ට්‍රෝනය"], c: 1, ex: ["අණුවක් පරමාණු එකතු වී සෑදේ.", "පරමාණුව මූලික ඒකකයයි.", "සෛලය ජීවීන්ගේ ඒකකයයි.", "ඉලෙක්ට්‍රෝනය අංශුවකි."]}],
        "ICT": [{q: "පහත ඒවායින් ප්‍රධාන මතකය වන්නේ?", o: ["Hard Disk", "RAM", "DVD", "Flash Drive"], c: 1, ex: ["Hard Disk ද්විතීයිකයි.", "RAM යනු ප්‍රධාන මතකයයි.", "DVD ද්විතීයිකයි.", "Flash Drive බාහිරයි."]}],
        "රසායන විද්‍යාව": [{q: "H2O අණුවේ හැඩය කුමක්ද?", o: ["රේඛීය", "කෝණික", "චතුස්තලීය", "තල ත්‍රිකෝණාකාර"], c: 1, ex: ["H2O වල හුදකලා යුගල නිසා හැඩය කෝණික වේ.", "CO2 රේඛීය වේ.", "CH4 චතුස්තලීය වේ.", "BF3 තල ත්‍රිකෝණාකාර වේ."]}]
    };

    function selectGrade(grade) {
        currentGrade = grade;
        document.getElementById('gradeScreen').classList.add('hidden');
        document.getElementById('subjectScreen').classList.remove('hidden');
        document.getElementById('selectedGradeTitle').innerText = "Grade " + grade + " විෂයන්";
        
        const list = document.getElementById('subjectList');
        list.innerHTML = "";
        const subs = subjectsPerGrade[grade] || subjectsPerGrade["6"];
        
        subs.forEach(s => {
            const btn = document.createElement('div');
            btn.className = 'menu-btn';
            btn.innerText = s;
            btn.onclick = () => startQuiz(s);
            list.appendChild(btn);
        });
    }

    function startQuiz(sub) {
        currentSubject = sub;
        document.getElementById('subjectScreen').classList.add('hidden');
        document.getElementById('quizArea').classList.remove('hidden');
        document.getElementById('subName').innerText = sub;
        score = 0; qIdx = 0;
        loadQuestion();
    }

    function loadQuestion() {
        const qList = questionsDB[currentSubject] || questionsDB["විද්‍යාව"];
        const q = qList[qIdx];
        document.getElementById('qCount').innerText = `ප්‍රශ්නය ${qIdx + 1}`;
        document.getElementById('qTxt').innerText = q.q;
        const cont = document.getElementById('optCont');
        cont.innerHTML = "";
        document.getElementById('nextBtn').classList.add('hidden');

        q.o.forEach((opt, i) => {
            const d = document.createElement('div');
            d.className = 'option';
            d.innerHTML = `<b>${i+1}.</b> ${opt} <div class="explanation">${q.ex[i]}</div>`;
            d.onclick = () => {
                document.querySelectorAll('.option').forEach(el => el.style.pointerEvents = 'none');
                if(i === q.c) { d.classList.add('correct'); score += 10; }
                else { d.classList.add('wrong'); document.querySelectorAll('.option')[q.c].classList.add('correct'); }
                document.querySelectorAll('.explanation').forEach(e => e.style.display = 'block');
                document.getElementById('nextBtn').classList.remove('hidden');
            };
            cont.appendChild(d);
        });
    }

    function nextQuestion() {
        const qList = questionsDB[currentSubject] || questionsDB["විද්‍යාව"];
        qIdx++;
        if(qIdx < qList.length) loadQuestion();
        else showResults();
    }

    function showResults() {
        document.getElementById('quizArea').classList.add('hidden');
        document.getElementById('resultScreen').classList.remove('hidden');
        document.getElementById('finalScore').innerText = score;
        
        const ctx = document.getElementById('progChart').getContext('2d');
        new Chart(ctx, {
            type: 'bar',
            data: { labels: ['ලබාගත් ලකුණු'], datasets: [{ label: 'Score', data: [score], backgroundColor: '#238636' }] },
            options: { maintainAspectRatio: false }
        });
    }

    function goBack(screenId) {
        document.getElementById('subjectScreen').classList.add('hidden');
        document.getElementById('quizArea').classList.add('hidden');
        document.getElementById(screenId).classList.remove('hidden');
    }
</script>
</body>
</html>
